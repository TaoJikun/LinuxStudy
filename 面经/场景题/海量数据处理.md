[toc]


# 1、如何从大量的 URL 中找出相同的 URL？

题目描述：给定 a、b 两个文件，各存放 50 亿个 URL，每个 URL 各占 64B，内存限制是 4G。请找出 a、b 两个文件共同的 URL。

分治策略：
1. 首先创建2n个小文件，其中n个存储文件a中的URL，另外n个存储文件b中的URL，对每个小文件都标记一个哈希值的范围，存储a中URL的小文件能够和存储b中的小文件的哈希值范围对应。
2. 遍历文件a，将遍历到的URL求一个哈希值，将这个URL写入到对应的范围的一个文件中。然后遍历文件b，将遍历到的URL求一个哈希值，将这个URL写入到对应的范围的一个文件中。
3. 遍历小文件ai，将其中所有的URL存储到一个哈希表中，然后遍历小文件bi，查看每一条URL是否存在于哈希表中，若存在即为相同的URL。



# 2、如何从大量数据中找出高频词？

题目描述：有一个 1GB 大小的文件，文件里每一行是一个词，每个词的大小不超过 16B，内存大小限制是 1MB，要求返回频数最高的 100 个词(Top 100)。

分治策略：
1. 先创建n个小文件，对每个小文件都标记一个哈希值的范围。
2. 遍历文件中的所有的单词，对其求一个哈希值，然后放入对应的小文件中。
3. 遍历小文件中的所有单词，用一个unordered_map存储其出现的频率，然后使用一个大小为100的小顶堆，获取这个小文件中出现频率最高的100个单词（频次大于小顶堆堆顶的单词，先将堆顶删除，然后将这个新的单词插入堆中）。
4. 重复步骤3，对每个小文件都找出频次最高的100个单词，将单词和其频次放入一个文件中，直至这个文件能完全读入到内存中，且还存在能够存放100大小的小顶堆。



# 3、如何找出某一天访问百度网站最多的 IP？

题目描述：现有海量日志数据保存在一个超大文件中，该文件无法直接读入内存，要求从中提取某天访问百度次数最多的那个IP。

分而治之->统计频次->重复至能载入内存->遍历获取最大的频次的



# 4、如何在大量的数据中找出不重复的整数？

题目描述：在 2.5 亿个整数中找出不重复的整数。注意：内存不足以容纳这 2.5 亿个整数。

方法一：分治+哈希

方法二：位图法
1. 用2bit来表示一个数字的状态：00表示这个数字没出现过、01表示这个数字出现过一次（即为题目所找的不重复整数）、10表示这个数字出现了多次。那么2.5亿个数字需要5亿个比特位，大概为60M左右的内存空间，只要内存大于60M即可使用该方法。
2. 遍历所有的数据，如果对应的状态为00则将状态置为01，对应状态为10则将状态置为10，最终统计状态为01的个数。



# 5、如何在大量的数据中判断一个数是否存在？

题目描述：给定 40 亿个不重复的没排过序的 unsigned int 型整数，然后再给定一个数，如何快速判断这个数是否在这 40 亿个整数当中？

位图法：
1. 在内存中开辟40亿位（即大约为512M）。
2. 遍历所有的数据，将对应的比特位设置为1。
3. 读取要查询的数对应的位，如果比特位为1，则这个数存在于数据集中。



# 6、如何查询最热门的查询串？

题目描述：搜索引擎会通过日志文件把用户每次检索使用的所有查询串都记录下来，每个查询串的长度不超过 255 字节。假设目前有 1000w 个记录（这些查询串的重复度比较高，虽然总数是 1000w，但如果除去重复后，则不超过 300w 个）。请统计最热门的 10 个查询串，要求使用的内存不能超过 1G。（一个查询串的重复度越高，说明查询它的用户越多，也就越热门。）

方法一：分治+小顶堆

方法二：unordred_map法
1. 由于去重后不超过300W条数据，那么如果用unordred_map统计出现频次的话，需要300W*(225+4)bytes≈750M（由于还需要存一个int来统计次数，所以要+4），1G内存够用。
2. 遍历所有记录，统计频率。
3. 小顶堆找top N。

方法三：前缀树法



# 7、如何统计不同电话号码的个数？

题目描述：已知某个文件内包含一些电话号码，每个号码为 8 位数字，统计不同号码的个数。

8位数字最多能表示10^8个电话号码，因此这题等效于统计数据重复的问题，使用位图法。



# 8、如何从 5 亿个数中找出中位数？

题目描述：从 5 亿个数中找出中位数。数据排序后，位置在最中间的数就是中位数。当样本数为奇数时，中位数为 第 (N+1)/2 个数；当样本数为偶数时，中位数为 第 N/2 个数与第 1+N/2 个数的均值。

方法一：内存较大时，使用双堆法（即力扣题数据流中的中位数）

方法二：分治策略
1. 按照数据的二进制最高位为1还是0，将5亿个数分成两半，最高位为1的数一定小于最高位为0的数（最高位为符号位，为1这个数是负数）。
2. 根据这两部分的数字个数，可以判断中位数位于哪一部分，然后记录小的一部分的个数，在大的那一部分中找中位数。
3. 再用次高位、次次高位依次进行，直到找到中位数。



# 9、如何按照 query 的频度排序？

题目描述：有 10 个文件，每个文件大小为 1G，每个文件的每一行存放的都是用户的 query，每个文件的 query 都可能重复。要求按照 query 的频度排序。

* 当重复度高时，可以直接一次读进内存，使用unordered_map进行统计频次。
* 当重复度不高时，可以采用分治策略，将文件中的数据分到小文件中进行统计频次，然后将所有小文件统计后的结果写入到一个文件中。最后对所有的文件进行归并排序。



# 10、如何找出排名前 500 的数？

题目描述：有 20 个数组，每个数组有 500 个元素，并且有序排列。如何在这 20*500 个数中找出前 500 的数？

使用一个大小为20的堆，然后将每个数组中的第一个元素放入堆中，将堆顶的元素取出后，将对应的数组中的下一个元素补进堆中，如此重复得到排名前500的元素。



# 11、游戏排名查询

题目描述：100万个选手，每个选手有对应的id和分数，要求参赛选手可查询分数前100的名单，和自己的排名，同时，排名可能随时更新，可能一天是10万级的更新，因此对应的前100名单和选手排名也要更新。

* 使用桶排序，根据不同分段，将不同的pair<uid，socre>放进不同的桶中，桶内放置链表。
* 对于uid，使用hashMap，能迅速通过uid查找到score，然后找到对应的桶，在桶内的位置，就可以知道自己的排名。
* 查询前100名：去前100名的桶内，查找即可。
* 十万级别的更新：一样，根据hashMap查找uid对应score，去对应桶中拿到元素，删除节点，然后找寻新桶再放入。
